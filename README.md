# RARP ‚Äî Reverse Address Resolution Protocol

–ù–∞–≤—á–∞–ª—å–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É **RARP** (RFC 903) –Ω–∞ Python (Scapy) —Ç–∞ C (BPF).  
RARP –¥–æ–∑–≤–æ–ª—è—î –∫–ª—ñ—î–Ω—Ç—É –¥—ñ–∑–Ω–∞—Ç–∏—Å—å —Å–≤–æ—é IP-–∞–¥—Ä–µ—Å—É, –º–∞—é—á–∏ –ª–∏—à–µ MAC-–∞–¥—Ä–µ—Å—É.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

| –§–∞–π–ª | –û–ø–∏—Å |
|------|------|
| `rarp_client.py` | Python-–∫–ª—ñ—î–Ω—Ç: –Ω–∞–¥—Å–∏–ª–∞—î RARP Request —ñ —á–µ–∫–∞—î Reply |
| `rarp_server.py` | Python-—Å–µ—Ä–≤–µ—Ä: –ø—Ä–∏–π–º–∞—î RARP Request —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î IP |
| `rarp_send.c` | C-—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç–∞ —á–µ—Ä–µ–∑ BPF (BSD/macOS) |
| `requirements.txt` | –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Python |

---

## ‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
pip install -r requirements.txt
```

> **Windows:** —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–µ–Ω [Npcap](https://npcap.com/) –¥–ª—è —Ä–æ–±–æ—Ç–∏ Scapy.

---

## üñ•Ô∏è rarp_client.py ‚Äî RARP-–∫–ª—ñ—î–Ω—Ç

–ù–∞–¥—Å–∏–ª–∞—î —à–∏—Ä–æ–∫–æ–º–æ–≤–Ω–∏–π RARP Request —ñ –æ—á—ñ–∫—É—î Reply –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞.

```bash
python rarp_client.py [OPTIONS]
```

### –ê—Ä–≥—É–º–µ–Ω—Ç–∏

| –ö–ª—é—á | –î–æ–≤–≥–∏–π –∫–ª—é—á | –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º | –û–ø–∏—Å |
|------|-------------|-----------------|------|
| `-m` | `--mac` | MAC –∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É | MAC-–∞–¥—Ä–µ—Å–∞ –∫–ª—ñ—î–Ω—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç: `00:0c:29:11:22:33`) |
| `-i` | `--iface` | –∞–≤—Ç–æ | –ù–∞–∑–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É (`Ethernet` –∞–±–æ `\Device\NPF_...`) |
| `-t` | `--timeout` | `60` | –ß–∞—Å –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —Å–µ–∫—É–Ω–¥–∏ |

### –ü—Ä–∏–∫–ª–∞–¥–∏

```bash
# –ê–≤—Ç–æ-–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É —Ç–∞ MAC
python rarp_client.py

# –í–∫–∞–∑–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π MAC —ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
python rarp_client.py -m 00:0c:29:11:22:33 -i Ethernet

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ç–∞–π–º–∞—É—Ç 10 —Å–µ–∫—É–Ω–¥
python rarp_client.py -t 10
```

---

## üñß rarp_server.py ‚Äî RARP-—Å–µ—Ä–≤–µ—Ä

–°–ª—É—Ö–∞—î –º–µ—Ä–µ–∂—É, –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î RARP Request —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î Reply –∑ IP-–∞–¥—Ä–µ—Å–æ—é.

```bash
python rarp_server.py [OPTIONS]
```

### –ê—Ä–≥—É–º–µ–Ω—Ç–∏

| –ö–ª—é—á | –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º | –û–ø–∏—Å |
|------|-----------------|------|
| `-i`, `--interface` | –∞–≤—Ç–æ | –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è |
| `--all` | –≤–∏–º–∫–Ω–µ–Ω–æ | –°–ª—É—Ö–∞—Ç–∏ –≤—Å—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ |
| `--assign-ip` | –≤–∏–ø–∞–¥–∫–æ–≤–∞ `192.168.X.Y` | –§—ñ–∫—Å–æ–≤–∞–Ω–∞ IP –¥–ª—è –≤–∏–¥–∞—á—ñ –∫–ª—ñ—î–Ω—Ç—É |
| `--logfile` | `rarp_server.log` | –®–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É –ª–æ–≥—É |

### –ü—Ä–∏–∫–ª–∞–¥–∏

```bash
# –ó–∞–ø—É—Å–∫ —ñ–∑ –∞–≤—Ç–æ-–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
python rarp_server.py

# –§—ñ–∫—Å–æ–≤–∞–Ω–∞ IP –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ
python rarp_server.py -i Ethernet --assign-ip 192.168.1.100

# –°–ª—É—Ö–∞—Ç–∏ –≤—Å—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏, –ª–æ–≥ —É –∫–∞—Å—Ç–æ–º–Ω–∏–π —Ñ–∞–π–ª
python rarp_server.py --all --logfile my.log
```

---

## üîß rarp_send.c ‚Äî C-–∫–ª—ñ—î–Ω—Ç (BSD/macOS)

–ù–∏–∑—å–∫–æ—Ä—ñ–≤–Ω–µ–≤–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ `/dev/bpf*`. –í–∏–º–∞–≥–∞—î C-–∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä.

```bash
# –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è
gcc rarp_send.c -o rarp_send

# –ù–∞–¥–∞—Ç–∏ –ø—Ä–∞–≤–∞ –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
chmod +x rarp_send

# –ó–∞–ø—É—Å–∫ (–ø–æ—Ç—Ä–µ–±—É—î root –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ BPF)
sudo ./rarp_send
```

> MAC-–∞–¥—Ä–µ—Å–∞ –∫–ª—ñ—î–Ω—Ç–∞ –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∞ —É —Ñ–∞–π–ª—ñ: `{0x00, 0x0c, 0x29, 0x11, 0x22, 0x33}`.  
> –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: `lnc0`. –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –∫–æ–¥ –ø—ñ–¥ —Å–≤–æ—ó –ø–æ—Ç—Ä–µ–±–∏.

---

## üî¨ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞—Ñ—ñ–∫—É (WireShark)

–î–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è RARP-–ø–∞–∫–µ—Ç—ñ–≤ —É **WireShark** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ñ—ñ–ª—å—Ç—Ä:

```
eth.type == 0x8035
```

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–Ω—è |
|------|----------|
| EtherType | `0x8035` (RARP) |
| Opcode 3 | RARP Request |
| Opcode 4 | RARP Reply |

> –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä —ñ –∫–ª—ñ—î–Ω—Ç, –≤—ñ–¥–∫—Ä–∏–π—Ç–µ WireShark –Ω–∞ —Ç–æ–º—É —Å–∞–º–æ–º—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ ‚Äî –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –æ–±–º—ñ–Ω –ø–∞–∫–µ—Ç–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.

---

## üîó –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- **Python ‚â• 3.8**
- **[Scapy](https://scapy.net/) ‚â• 2.5.0**
- **Npcap** (—Ç—ñ–ª—å–∫–∏ Windows) ‚Äî [npcap.com](https://npcap.com/)

---

## üìñ –ü—Ä–æ—Ç–æ–∫–æ–ª

| –ü–æ–ª–µ | Request | Reply |
|------|---------|-------|
| Opcode | 3 | 4 |
| hwsrc | MAC –∫–ª—ñ—î–Ω—Ç–∞ | MAC —Å–µ—Ä–≤–µ—Ä–∞ |
| hwdst | `ff:ff:ff:ff:ff:ff` | MAC –∫–ª—ñ—î–Ω—Ç–∞ |
| psrc | `0.0.0.0` | IP –∫–ª—ñ—î–Ω—Ç–∞ (–≤–∏–¥–∞–Ω–∞) |
| pdst | `0.0.0.0` | `0.0.0.0` |

> –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è: [RFC 903](https://www.rfc-editor.org/rfc/rfc903)
